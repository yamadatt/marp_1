{"version":3,"file":"token-utils.js","names":["Object","defineProperty","exports","value","restoreToSurfaceFromKey","is括弧Token","is助詞Token","create読点Matcher","createKeyFromKey","concatJoishiTokens","token","test","pos","pos_detail_1","commaCharacters","is読点Token","includes","surface_form","concatToken","aToken","bToken","tokens","newTokens","forEach","prevToken","length","push","concat","pos_detail_2","pos_detail_3","key","split"],"sources":["../src/token-utils.ts"],"sourcesContent":["// LICENSE : MIT\n\"use strict\";\n\nimport { KuromojiToken } from \"kuromojin\";\n\n// 助詞どうか\nexport const is助詞Token = (token: KuromojiToken) => {\n    // 結合しているtokenは助詞助詞のようになってるため先頭一致で見る\n    return token && /^助詞/.test(token.pos);\n};\n\nexport const is括弧Token = (token: KuromojiToken) => {\n    return token && token.pos === \"記号\" && (token.pos_detail_1 === \"括弧開\" || token.pos_detail_1 === \"括弧閉\");\n};\n\n/**\n * 読点を判定する関数を返す\n * 注意: 名詞や記号ではないトークンは読点として扱えない\n * @param commaCharacters\n */\nexport const create読点Matcher = (commaCharacters: string[]) => {\n    return function is読点Token(token: KuromojiToken) {\n        return (\n            commaCharacters.includes(token.surface_form) &&\n            // 、や, は名詞扱いの場合がある(0.1.2で記号となる)\n            (token.pos === \"名詞\" ||\n                // ，は記号 && 読点となる(surface_formを優先するために pos_detail_1/読点 のチェックを省く)\n                token.pos === \"記号\")\n        );\n    };\n};\n/**\n * aTokenの_extraKeyに結合したkeyを追加する\n * @param {Object} aToken\n * @param {Object} bToken\n * @returns {Object}\n */\nconst concatToken = (aToken: KuromojiToken, bToken: KuromojiToken) => {\n    aToken.surface_form += bToken.surface_form;\n    aToken.pos += bToken.pos;\n    aToken.pos_detail_1 += bToken.surface_form;\n    return aToken;\n};\n/**\n * 助詞+助詞 というように連続しているtokenを結合し直したtokenの配列を返す\n * @param {Array} tokens\n * @returns {Array}\n */\nexport const concatJoishiTokens = (tokens: KuromojiToken[]) => {\n    const newTokens: KuromojiToken[] = [];\n    tokens.forEach((token) => {\n        const prevToken = newTokens[newTokens.length - 1];\n        if (is助詞Token(token) && is助詞Token(prevToken)) {\n            newTokens[newTokens.length - 1] = concatToken(prevToken, token);\n        } else {\n            newTokens.push(token);\n        }\n    });\n    return newTokens;\n};\n// 助詞tokenから品詞細分類1までを元にしたkeyを作る\n// http://www.unixuser.org/~euske/doc/postag/index.html#chasen\n// http://chasen.naist.jp/snapshot/ipadic/ipadic/doc/ipadic-ja.pdf\nexport const createKeyFromKey = (token: KuromojiToken) => {\n    // e.g.) \"は:助詞.係助詞.*.*\"\n    // \"しようとすると\" と には次の違いある\n    // と\t助詞\t格助詞\t一般 *\n    // と\t助詞\t接続助詞\t*\t*\n    return `${token.surface_form}:${token.pos}.${token.pos_detail_1}.${token.pos_detail_2}.${token.pos_detail_3}`;\n};\n// keyからsurfaceを取り出す\nexport const restoreToSurfaceFromKey = (key: string) => {\n    return key.split(\":\")[0];\n};\n"],"mappings":"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"}