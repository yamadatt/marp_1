{"version":3,"file":"SourceCode.js","names":["Object","defineProperty","exports","value","SourceCode","constructor","text","index","contextLocations","enterContext","pairMark","push","leaveContext","findIndex","context","key","splice","isInContext","length","some","contextLocation","canRead","read","undefined","peek"],"sources":["../../src/parser/SourceCode.js"],"sourcesContent":["// MIT Â© 2018 azu\n\"use strict\";\n\nexport class SourceCode {\n    constructor(text) {\n        this.text = text;\n        this.index = 0;\n        /** @type {{index:number, pairMark: PairMark}}[] */\n        this.contextLocations = [];\n    }\n\n    enterContext(pairMark) {\n        this.contextLocations.push({\n            index: this.index + 1,\n            pairMark\n        });\n    }\n\n    leaveContext(pairMark) {\n        const index = this.contextLocations.findIndex((context) => {\n            return context.pairMark.key === pairMark.key;\n        });\n        if (index !== -1) {\n            this.contextLocations.splice(index, 1);\n        }\n    }\n\n    isInContext(pairMark) {\n        if (!pairMark) {\n            return this.contextLocations.length > 0;\n        }\n        return this.contextLocations.some((contextLocation) => contextLocation.pairMark.key === pairMark.key);\n    }\n\n    /**\n     * Return true, no more read char\n     */\n    get canRead() {\n        return this.read() !== undefined;\n    }\n\n    read() {\n        return this.text[this.index];\n    }\n\n    peek(index = 1) {\n        this.index += index;\n    }\n}\n"],"mappings":"AAAA;AACA,YAAY;;AAACA,MAAA,CAAAC,cAAA,CAAAC,OAAA;EAAAC,KAAA;AAAA;AAAAD,OAAA,CAAAE,UAAA;AAEN,MAAMA,UAAU,CAAC;EACpBC,WAAWA,CAACC,IAAI,EAAE;IACd,IAAI,CAACA,IAAI,GAAGA,IAAI;IAChB,IAAI,CAACC,KAAK,GAAG,CAAC;IACd;IACA,IAAI,CAACC,gBAAgB,GAAG,EAAE;EAC9B;EAEAC,YAAYA,CAACC,QAAQ,EAAE;IACnB,IAAI,CAACF,gBAAgB,CAACG,IAAI,CAAC;MACvBJ,KAAK,EAAE,IAAI,CAACA,KAAK,GAAG,CAAC;MACrBG;IACJ,CAAC,CAAC;EACN;EAEAE,YAAYA,CAACF,QAAQ,EAAE;IACnB,MAAMH,KAAK,GAAG,IAAI,CAACC,gBAAgB,CAACK,SAAS,CAAEC,OAAO,IAAK;MACvD,OAAOA,OAAO,CAACJ,QAAQ,CAACK,GAAG,KAAKL,QAAQ,CAACK,GAAG;IAChD,CAAC,CAAC;IACF,IAAIR,KAAK,KAAK,CAAC,CAAC,EAAE;MACd,IAAI,CAACC,gBAAgB,CAACQ,MAAM,CAACT,KAAK,EAAE,CAAC,CAAC;IAC1C;EACJ;EAEAU,WAAWA,CAACP,QAAQ,EAAE;IAClB,IAAI,CAACA,QAAQ,EAAE;MACX,OAAO,IAAI,CAACF,gBAAgB,CAACU,MAAM,GAAG,CAAC;IAC3C;IACA,OAAO,IAAI,CAACV,gBAAgB,CAACW,IAAI,CAAEC,eAAe,IAAKA,eAAe,CAACV,QAAQ,CAACK,GAAG,KAAKL,QAAQ,CAACK,GAAG,CAAC;EACzG;;EAEA;AACJ;AACA;EACI,IAAIM,OAAOA,CAAA,EAAG;IACV,OAAO,IAAI,CAACC,IAAI,CAAC,CAAC,KAAKC,SAAS;EACpC;EAEAD,IAAIA,CAAA,EAAG;IACH,OAAO,IAAI,CAAChB,IAAI,CAAC,IAAI,CAACC,KAAK,CAAC;EAChC;EAEAiB,IAAIA,CAACjB,KAAK,GAAG,CAAC,EAAE;IACZ,IAAI,CAACA,KAAK,IAAIA,KAAK;EACvB;AACJ;AAACL,OAAA,CAAAE,UAAA,GAAAA,UAAA","ignoreList":[]}